---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

export async function getStaticPaths() {
  const guides = await getCollection('guides');
  return guides.map((guide) => ({
    params: { slug: guide.slug },
    props: { guide },
  }));
}

const { guide } = Astro.props;
const { Content } = await guide.render();

// Create schema for SEO
const articleSchema = {
  "@context": "https://schema.org",
  "@type": "TechArticle",
  "headline": guide.data.title,
  "description": guide.data.description,
  "author": {
    "@type": "Organization",
    "name": "RevOps JET",
    "url": "https://revopsjet.com"
  },
  "publisher": {
    "@type": "Organization",
    "name": "RevOps JET",
    "logo": {
      "@type": "ImageObject",
      "url": "https://revopsjet.com/favicon.svg"
    }
  },
  "datePublished": guide.data.publishDate.toISOString(),
  "dateModified": guide.data.lastUpdated.toISOString(),
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": `https://revopsjet.com/blog/${guide.slug}`
  },
  "proficiencyLevel": guide.data.difficulty,
  "timeRequired": `PT${guide.data.timeToImplement}M`
};

// FAQ Schema for enriched SEO
const faqSchema = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "What is the difference between real-time and batch enrichment?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Real-time enrichment updates contact records instantly when they enter your CRM, ideal for speed-to-lead scenarios like routing hot leads. Batch enrichment processes records in scheduled groups, making it more economical for refreshing existing databases. Most teams use a combination of both approaches."
      }
    },
    {
      "@type": "Question",
      "name": "How does data enrichment affect data privacy?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Data enrichment must comply with regulations like GDPR and CCPA. Reputable vendors ensure ethical data sourcing and proper consent handling. When vetting vendors, ask about their compliance practices and data sourcing methods to protect your business and customers."
      }
    },
    {
      "@type": "Question",
      "name": "What's the difference between firmographic and demographic data?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Firmographics describe the company as a whole—industry, revenue, employee count, location. Demographics focus on individual contacts within that company—job title, seniority, department, and role. You need both: firmographics identify if a company fits your ICP, demographics identify who to contact."
      }
    },
    {
      "@type": "Question",
      "name": "How much does B2B data enrichment cost?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Pricing ranges from $0.10-$2.00 per contact for basic enrichment to $20,000-$100,000+ annually for enterprise solutions. Smaller teams typically start around $1,000-$3,000/month with providers like Clearbit or ZoomInfo. Calculate cost-per-enriched-lead against conversion lift to ensure positive ROI."
      }
    },
    {
      "@type": "Question",
      "name": "Which data enrichment vendors are best for SaaS companies?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Top vendors for SaaS include Clearbit (tech stack data), ZoomInfo (comprehensive B2B database), Apollo.io (affordable with prospecting), and Clay (flexible data aggregation). Choice depends on your ICP, budget, and integration requirements with existing CRM and marketing tools."
      }
    },
    {
      "@type": "Question",
      "name": "How do I measure data enrichment ROI?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Track lead-to-opportunity conversion rate (should increase 20-30%), time to qualify leads (should decrease 30-50%), sales pipeline velocity, and marketing engagement rates. Calculate total enrichment costs against incremental revenue from improved conversions. Most teams see 3-5x ROI within the first year."
      }
    },
    {
      "@type": "Question",
      "name": "Can I enrich data already in my CRM, or only new leads?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "You can enrich both existing and new data. Retroactive enrichment refreshes your entire CRM database via bulk batch processing. Prospective enrichment handles new leads in real-time or scheduled batches. Start with a one-time database cleanup, then maintain with ongoing enrichment."
      }
    },
    {
      "@type": "Question",
      "name": "How often should I refresh my enriched data?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Refresh high-value accounts quarterly and your full database annually for most B2B companies. Fast-moving industries like tech startups should update every 90 days minimum. Prioritize records in active sales pipelines or recently engaged with marketing campaigns."
      }
    }
  ]
};

// Combine schemas
const schema = [articleSchema, faqSchema];
---

<BaseLayout
  title={guide.data.title}
  description={guide.data.description}
  schema={schema}
>
  <style>
    .article-header {
      padding: 3rem 0;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      text-align: center;
    }

    .article-title {
      font-size: 2.5rem;
      font-weight: 800;
      margin-bottom: 1rem;
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
    }

    .article-meta {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
      font-size: 0.875rem;
    }

    .badge {
      display: inline-block;
      padding: 0.375rem 0.75rem;
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border-radius: 0.25rem;
      font-weight: 600;
      text-transform: capitalize;
    }

    .badge.ai {
      background: rgba(59, 130, 246, 0.3);
    }

    .article-content {
      max-width: 800px;
      margin: 3rem auto;
      padding: 0 1.5rem;
      line-height: 1.8;
    }

    .article-content h2 {
      font-size: 1.875rem;
      font-weight: 700;
      margin: 2.5rem 0 1rem;
      color: #1a1a1a;
    }

    .article-content h3 {
      font-size: 1.5rem;
      font-weight: 600;
      margin: 2rem 0 0.75rem;
      color: #1a1a1a;
    }

    .article-content p {
      margin-bottom: 1.5rem;
      color: #4b5563;
    }

    .article-content ul,
    .article-content ol {
      margin-bottom: 1.5rem;
      padding-left: 2rem;
      color: #4b5563;
    }

    .article-content li {
      margin-bottom: 0.5rem;
    }

    .article-content code {
      background: #f3f4f6;
      padding: 0.2rem 0.4rem;
      border-radius: 0.25rem;
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 0.875em;
    }

    .article-content pre {
      background: #1a1a1a;
      color: #f5f5f7;
      padding: 1.5rem;
      border-radius: 0.5rem;
      overflow-x: auto;
      margin-bottom: 1.5rem;
    }

    .article-content pre code {
      background: none;
      padding: 0;
      color: #f5f5f7;
    }

    /* Image sizing */
    .article-content :global(img) {
      max-width: 100%;
      height: auto;
      border-radius: 0.5rem;
      margin: 2rem 0;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    /* Table styling */
    .article-content :global(table) {
      width: 100%;
      border-collapse: collapse;
      margin: 2rem 0;
      background: white;
      border-radius: 0.5rem;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    .article-content :global(th) {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 1rem;
      text-align: left;
      font-weight: 600;
      font-size: 0.875rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .article-content :global(td) {
      padding: 1rem;
      border-bottom: 1px solid #e5e7eb;
      color: #4b5563;
    }

    .article-content :global(tr:last-child td) {
      border-bottom: none;
    }

    .article-content :global(tr:hover) {
      background: #f9fafb;
    }

    .back-link {
      display: inline-block;
      margin-bottom: 2rem;
      color: #667eea;
      font-weight: 600;
      text-decoration: none;
    }

    .back-link:hover {
      text-decoration: underline;
    }
  </style>

  <article>
    <header class="article-header">
      <h1 class="article-title">{guide.data.title}</h1>
      <div class="article-meta">
        <span class="badge">{guide.data.tool}</span>
        <span class="badge">{guide.data.useCase}</span>
        <span class="badge">{guide.data.difficulty}</span>
        <span class="badge">{guide.data.timeToImplement} min read</span>
      </div>
    </header>

    <div class="article-content">
      <a href="/blog" class="back-link">← Back to Blog</a>
      <Content />
    </div>
  </article>
</BaseLayout>
